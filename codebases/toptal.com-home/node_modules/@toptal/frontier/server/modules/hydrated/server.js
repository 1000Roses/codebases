import React, {
    useContext
} from 'react'

import {
    serialize
} from './process-payload'
import HydrationContext from './HydrationContext'

/**
 * Renders Component on the server for future hydration
 * with its props safely serialized.
 *
 * @param {React.Component} Component
 * @param {string} hydrationId
 */
function withProps(Component, hydrationId) {
    return function(props) {
        const addHydrationData = useContext(HydrationContext)
        addHydrationData && addHydrationData(hydrationId, serialize(props))
        return ( <
            div data - cid = {
                hydrationId
            } >
            <
            Component { ...props
            }
            /> <
            /div>
        )
    }
}

export {
    withProps
}